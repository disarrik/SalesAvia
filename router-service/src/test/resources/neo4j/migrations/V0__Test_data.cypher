CREATE CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;
CALL db.awaitIndexes(300);
UNWIND [{_id:0, properties:{city:"Baiyun-Huadu", airportId:"1", name:"Guangzhou Baiyun International Airport"}}, {_id:1, properties:{city:"Atlanta", airportId:"2", name:"Hartsfield–Jackson Atlanta International Airport"}}, {_id:2, properties:{city:"Shuangliu-Wuhou", airportId:"3", name:"Chengdu Shuangliu International Airport"}}, {_id:3, properties:{city:"Dallas", airportId:"4", name:"Dallas/Fort Worth International Airport"}}, {_id:4, properties:{city:"Tokyo", airportId:"5", name:"Tokyo Haneda Airport"}}, {_id:5, properties:{city:"Delhi", airportId:"6", name:"Indira Gandhi International Airport"}}, {_id:6, properties:{city:"Dubai", airportId:"7", name:"Dubai International Airport"}}, {_id:7, properties:{city:"Paris", airportId:"8", name:"Charles de Gaulle Airport"}}, {_id:8, properties:{city:"Moscow", airportId:"9", name:"Sheremetyevo International Airport"}}, {_id:9, properties:{city:"Frankfurt", airportId:"10", name:"Frankfurt Airport"}}, {_id:10, properties:{city:"Madrid", airportId:"11", name:"Madrid Barajas Airport"}}, {_id:11, properties:{city:"Istanbul", airportId:"12", name:"Istanbul Sabiha Gökçen International Airport"}}] AS row
CREATE (n:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row._id}) SET n += row.properties SET n:Airport;
UNWIND [{start: {_id:10}, end: {_id:11}, properties:{arrival:"2020-01-02T08:21:00Z", price:"92", departure:"2020-01-01T22:12:00Z"}}, {start: {_id:10}, end: {_id:8}, properties:{arrival:"2020-01-02T00:35:00Z", price:"80", departure:"2020-01-01T16:42:00Z"}}, {start: {_id:6}, end: {_id:7}, properties:{arrival:"2020-01-02T06:58:00Z", price:"50", departure:"2020-01-01T21:37:00Z"}}, {start: {_id:9}, end: {_id:7}, properties:{arrival:"2020-01-02T04:19:00Z", price:"85", departure:"2020-01-01T22:27:00Z"}}, {start: {_id:11}, end: {_id:5}, properties:{arrival:"2020-01-01T23:37:00Z", price:"83", departure:"2020-01-01T19:18:00Z"}}, {start: {_id:11}, end: {_id:8}, properties:{arrival:"2020-01-02T02:17:00Z", price:"65", departure:"2020-01-01T19:09:00Z"}}, {start: {_id:10}, end: {_id:9}, properties:{arrival:"2020-01-02T02:50:00Z", price:"75", departure:"2020-01-01T20:39:00Z"}}, {start: {_id:7}, end: {_id:0}, properties:{arrival:"2020-01-01T17:52:00Z", price:"46", departure:"2020-01-01T13:23:00Z"}}, {start: {_id:7}, end: {_id:6}, properties:{arrival:"2020-01-01T23:29:00Z", price:"94", departure:"2020-01-01T17:42:00Z"}}, {start: {_id:0}, end: {_id:2}, properties:{arrival:"2020-01-01T16:55:00Z", price:"49", departure:"2020-01-01T13:02:00Z"}}, {start: {_id:7}, end: {_id:5}, properties:{arrival:"2020-01-02T04:15:00Z", price:"70", departure:"2020-01-01T21:01:00Z"}}, {start: {_id:6}, end: {_id:10}, properties:{arrival:"2020-01-02T01:46:00Z", price:"83", departure:"2020-01-01T22:49:00Z"}}, {start: {_id:5}, end: {_id:6}, properties:{arrival:"2020-01-01T18:17:00Z", price:"56", departure:"2020-01-01T17:17:00Z"}}, {start: {_id:10}, end: {_id:5}, properties:{arrival:"2020-01-01T18:04:00Z", price:"69", departure:"2020-01-01T15:48:00Z"}}, {start: {_id:11}, end: {_id:2}, properties:{arrival:"2020-01-02T05:27:00Z", price:"72", departure:"2020-01-01T20:56:00Z"}}, {start: {_id:2}, end: {_id:10}, properties:{arrival:"2020-01-01T23:33:00Z", price:"77", departure:"2020-01-01T22:33:00Z"}}, {start: {_id:9}, end: {_id:8}, properties:{arrival:"2020-01-01T16:50:00Z", price:"51", departure:"2020-01-01T13:48:00Z"}}, {start: {_id:1}, end: {_id:0}, properties:{arrival:"2020-01-02T00:06:00Z", price:"90", departure:"2020-01-01T14:12:00Z"}}, {start: {_id:8}, end: {_id:6}, properties:{arrival:"2020-01-02T02:07:00Z", price:"46", departure:"2020-01-01T21:24:00Z"}}, {start: {_id:6}, end: {_id:3}, properties:{arrival:"2020-01-01T18:38:00Z", price:"49", departure:"2020-01-01T18:12:00Z"}}, {start: {_id:7}, end: {_id:5}, properties:{arrival:"2020-01-02T03:35:00Z", price:"95", departure:"2020-01-01T20:43:00Z"}}, {start: {_id:0}, end: {_id:3}, properties:{arrival:"2020-01-01T17:24:00Z", price:"64", departure:"2020-01-01T13:47:00Z"}}, {start: {_id:6}, end: {_id:11}, properties:{arrival:"2020-01-02T01:21:00Z", price:"58", departure:"2020-01-01T22:42:00Z"}}, {start: {_id:1}, end: {_id:9}, properties:{arrival:"2020-01-01T15:12:00Z", price:"74", departure:"2020-01-01T14:15:00Z"}}, {start: {_id:4}, end: {_id:1}, properties:{arrival:"2020-01-02T02:44:00Z", price:"72", departure:"2020-01-01T22:42:00Z"}}, {start: {_id:7}, end: {_id:4}, properties:{arrival:"2020-01-01T18:31:00Z", price:"75", departure:"2020-01-01T16:30:00Z"}}, {start: {_id:10}, end: {_id:8}, properties:{arrival:"2020-01-02T07:55:00Z", price:"40", departure:"2020-01-01T21:11:00Z"}}, {start: {_id:8}, end: {_id:2}, properties:{arrival:"2020-01-02T02:00:00Z", price:"65", departure:"2020-01-01T19:22:00Z"}}, {start: {_id:6}, end: {_id:3}, properties:{arrival:"2020-01-01T16:53:00Z", price:"61", departure:"2020-01-01T16:25:00Z"}}, {start: {_id:10}, end: {_id:4}, properties:{arrival:"2020-01-01T20:01:00Z", price:"83", departure:"2020-01-01T19:39:00Z"}}, {start: {_id:7}, end: {_id:11}, properties:{arrival:"2020-01-01T23:49:00Z", price:"51", departure:"2020-01-01T13:25:00Z"}}, {start: {_id:2}, end: {_id:5}, properties:{arrival:"2020-01-01T22:34:00Z", price:"63", departure:"2020-01-01T19:40:00Z"}}, {start: {_id:7}, end: {_id:4}, properties:{arrival:"2020-01-01T23:16:00Z", price:"79", departure:"2020-01-01T17:32:00Z"}}, {start: {_id:7}, end: {_id:1}, properties:{arrival:"2020-01-02T05:13:00Z", price:"82", departure:"2020-01-01T20:43:00Z"}}, {start: {_id:0}, end: {_id:11}, properties:{arrival:"2020-01-01T17:51:00Z", price:"89", departure:"2020-01-01T14:49:00Z"}}, {start: {_id:4}, end: {_id:10}, properties:{arrival:"2020-01-02T03:43:00Z", price:"59", departure:"2020-01-01T18:42:00Z"}}, {start: {_id:0}, end: {_id:9}, properties:{arrival:"2020-01-01T22:35:00Z", price:"58", departure:"2020-01-01T16:53:00Z"}}, {start: {_id:4}, end: {_id:8}, properties:{arrival:"2020-01-02T01:06:00Z", price:"89", departure:"2020-01-01T19:44:00Z"}}, {start: {_id:3}, end: {_id:10}, properties:{arrival:"2020-01-02T02:57:00Z", price:"59", departure:"2020-01-01T22:25:00Z"}}, {start: {_id:6}, end: {_id:5}, properties:{arrival:"2020-01-01T19:32:00Z", price:"44", departure:"2020-01-01T16:10:00Z"}}] AS row
MATCH (start:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.start._id})
MATCH (end:`UNIQUE IMPORT LABEL`{`UNIQUE IMPORT ID`: row.end._id})
CREATE (start)-[r:Travel]->(end) SET r += row.properties;
MATCH (n:`UNIQUE IMPORT LABEL`)  WITH n LIMIT 20000 REMOVE n:`UNIQUE IMPORT LABEL` REMOVE n.`UNIQUE IMPORT ID`;
DROP CONSTRAINT ON (node:`UNIQUE IMPORT LABEL`) ASSERT (node.`UNIQUE IMPORT ID`) IS UNIQUE;